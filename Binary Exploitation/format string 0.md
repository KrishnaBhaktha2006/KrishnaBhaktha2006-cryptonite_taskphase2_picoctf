# Format string 0

*Flag:* picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}

How you approached the challenge:

- step 1: I saw the first hint to start and it said to look up for format specifers and i searched it up in google and geeks for geeks link which i mentioned in refrence said that it should have % so basically while answering i chose options with % and in second question they told they want something outrageous that would break the shop
so i chose the one with more that 1 % and ot worked.


- step 2: The commands i used in terminal are 
wget and cat
```
root@Krish:~# wget https://artifacts.picoctf.net/c_mimas/77/format-string-0
--2024-11-05 17:04:22--  https://artifacts.picoctf.net/c_mimas/77/format-string-0
Resolving artifacts.picoctf.net (artifacts.picoctf.net)... 18.155.99.67, 18.155.99.118, 18.155.99.57, ...
Connecting to artifacts.picoctf.net (artifacts.picoctf.net)|18.155.99.67|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 16632 (16K) [application/octet-stream]
Saving to: ‘format-string-0’

format-string-0               100%[=================================================>]  16.24K  --.-KB/s    in 0s

2024-11-05 17:04:23 (237 MB/s) - ‘format-string-0’ saved [16632/16632]

root@Krish:~# wget https://artifacts.picoctf.net/c_mimas/77/format-string-0.c
--2024-11-05 17:04:29--  https://artifacts.picoctf.net/c_mimas/77/format-string-0.c
Resolving artifacts.picoctf.net (artifacts.picoctf.net)... 18.155.99.60, 18.155.99.57, 18.155.99.118, ...
Connecting to artifacts.picoctf.net (artifacts.picoctf.net)|18.155.99.60|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2784 (2.7K) [application/octet-stream]
Saving to: ‘format-string-0.c’

format-string-0.c             100%[=================================================>]   2.72K  --.-KB/s    in 0s

2024-11-05 17:04:31 (3.88 GB/s) - ‘format-string-0.c’ saved [2784/2784]

root@Krish:~# cat format-string-0
@@@@@@�@@@@��@@��  @ @  .>@>@p� . >@ >@�88@8@0hh@h@DDS�td88@8@0P�td�#�#@�#@TTQ�tdR�td.>@>@��/lib64/ld-linux-x86-64.so.2 ����݆`&N�� R��GNU)�4Wf � 9O'@a-␦�@fgets__libc_start_mainstrcmpsignalfopenstdoutputsfflush__isoc99_scanfgetegidsetresgidewu␦irint������?@�?�@@@@ @@(@@0@@8@@@@@H@@BC_2.34P@@mon_start__mii
X@@
   `@@
��H�H��/H��t��H���5�/��%�/��h���������h���������h���������h��������h��������h��������h��������h��q��������a������h     ��Q������h
/D����%/D����%�.D����%�.D����%�.D����%�.D����%�.D��1�I��^H��H���PTE1�1�H��@�;.�f.����f.����@@H=�@@t�H��t        ��@@��f��ff.�@��@@H��@@H��H��?H��H�H��t�H��t��@@���ff.�@���==.uUH���z����+.]Ð�ff.�@�����UH��H���}���@@ @��g���H��-H������������� @� @�(���H�E�H�}�u#� @�0 @�e @�������␦���H�E�H�¾@��@@�����v@���E�;E�|ø����UH��H�� �}�H�u�
                                                              ����������E�U�M�E�ΉǸ�F����������UH��H��PH�h�!@A�p @A�� @�� @�!@�P!@��!@�����H��H�{,H���3���H�E�H�ƿ�!@��M���H�E��!@H�E��!@H�E��!@H�M�H�EкH��H���_�����u�!@����H�,H��������NH�E�H�Ǹ�}����E��}�@~
            ��-�("@�3"@�L"@��O���H��+H�����������UH��H��@h�!@h8#@A�� @A�X"@��"@��"@��"@�������H��H�r+H���*���H�E�H�ƿ�!@��D���H�E�p#@H�Eȁ#@H�EВ#@H�M�H�E�H��H���V�����u�!@�v���H�+H�������� H�E�H�Ǹ�t���H��*H�����������H�H��
%s
rflag.txtown debugging flag.
Please create 'flag.txt' in this directory with your%s %sBreakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxePlease choose from the following burgers:Here comes the first customer Patrick who wants a giant bite.Can you help the picky customers find their favorite burger?Welcome to our newly-opened burger place Pico 'n Patty!%s %s
%s
%s %s
%sEnter your recommendation: %sBreakf@st_BurgerGr%114d_CheeseBac0n_D3luxeThere is no such burger yet!Try to serve him something of larger size!Patrick is still hungry!%s
%s
(better be served quick before the shop owner kicks you out!)Sponge Bob wants something outrageous that would break the shopNow can you serve the second customer?Good job! Patrick is happy!
%s %s
%s %s
%s %s
%sPe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steakPe%to_Portobello$outhwest_BurgerCla%sic_Che%s%steakT   x����8��������p���������
����n������4��TzRx


                 p���&D0����$D�����FJ
[���dE�C                             �?␦:*3$"lp���������<E�C
�R����E�C
����E�C
�����E�C
p@@@m
�@>␦>���o�@@@�@
�
 @�@HH  ���@���o���o�@ >@0@@@P@`@p@�@�@�@�@�@�@GCC: (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0��@ ���@@2@@H␦�@@T>@{p@�>@������%@��� >@��#@�@@�␦�@� p@@(9�@@@�@F\o�p@@��� �x@@� @��␦�@@��@��@&#�@d+␦�@@7@�<Ng�@�q��@@�␦�@@@���
                                                                                                @�v@<crt1.o__abi_tagcrtstuff.cderegister_tm_clones__do_global_dtors_auxcompleted.0__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entryformat-string-0.c__FRAME_END___DYNAMIC__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_start_main@GLIBC_2.34stdout@GLIBC_2.2.5puts@GLIBC_2.2.5_edata_finisetresgid@GLIBC_2.2.5printf@GLIBC_2.2.5fgets@GLIBC_2.2.5__data_startstrcmp@GLIBC_2.2.5signal@GLIBC_2.2.5__gmon_start____dso_handle_IO_stdin_usedfflush@GLIBC_2.2.5_end_dl_relocate_static_piegetegid@GLIBC_2.2.5on_menu__bss_startmainfopen@GLIBC_2.2.5__isoc99_scanf@GLIBC_2.7serve_bobexit@GLIBC_2.2.5__TMC_END__flagserve_patrick_initsigsegv_handler.symtab.strtab.shstrtab.interp.note.gnu.property.note.gnu.build-id.note.ABI-tag.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rela.dyn.rela.plt.init.plt.sec.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.dynamic.got.got.plt.data.bss.comment@#8@86h@h$I�@� W���o�@�a
� @ ��#@�#T�$@$��� >@ .��?@@@0p                                         �@�i@@@�q���o�@�~����H@H�B��@ @ ���@����@���@�
                             p@@�@@�0` 0�0+�0�  `5�8root@Krish:~# cat format-string-0.c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>
#include <unistd.h>
#include <sys/types.h>

#define BUFSIZE 32
#define FLAGSIZE 64

char flag[FLAGSIZE];

void sigsegv_handler(int sig) {
    printf("\n%s\n", flag);
    fflush(stdout);
    exit(1);
}

int on_menu(char *burger, char *menu[], int count) {
    for (int i = 0; i < count; i++) {
        if (strcmp(burger, menu[i]) == 0)
            return 1;
    }
    return 0;
}

void serve_patrick();

void serve_bob();


int main(int argc, char **argv){
    FILE *f = fopen("flag.txt", "r");
    if (f == NULL) {
        printf("%s %s", "Please create 'flag.txt' in this directory with your",
                        "own debugging flag.\n");
        exit(0);
    }

    fgets(flag, FLAGSIZE, f);
    signal(SIGSEGV, sigsegv_handler);

    gid_t gid = getegid();
    setresgid(gid, gid, gid);

    serve_patrick();

    return 0;
}

void serve_patrick() {
    printf("%s %s\n%s\n%s %s\n%s",
            "Welcome to our newly-opened burger place Pico 'n Patty!",
            "Can you help the picky customers find their favorite burger?",
            "Here comes the first customer Patrick who wants a giant bite.",
            "Please choose from the following burgers:",
            "Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe",
            "Enter your recommendation: ");
    fflush(stdout);

    char choice1[BUFSIZE];
    scanf("%s", choice1);
    char *menu1[3] = {"Breakf@st_Burger", "Gr%114d_Cheese", "Bac0n_D3luxe"};
    if (!on_menu(choice1, menu1, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        int count = printf(choice1);
        if (count > 2 * BUFSIZE) {
            serve_bob();
        } else {
            printf("%s\n%s\n",
                    "Patrick is still hungry!",
                    "Try to serve him something of larger size!");
            fflush(stdout);
        }
    }
}

void serve_bob() {
    printf("\n%s %s\n%s %s\n%s %s\n%s",
            "Good job! Patrick is happy!",
            "Now can you serve the second customer?",
            "Sponge Bob wants something outrageous that would break the shop",
            "(better be served quick before the shop owner kicks you out!)",
            "Please choose from the following burgers:",
            "Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak",
            "Enter your recommendation: ");
    fflush(stdout);

    char choice2[BUFSIZE];
    scanf("%s", choice2);
    char *menu2[3] = {"Pe%to_Portobello", "$outhwest_Burger", "Cla%sic_Che%s%steak"};
    if (!on_menu(choice2, menu2, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        printf(choice2);
        fflush(stdout);
    }
}
```


![image](https://github.com/user-attachments/assets/722eccd0-b025-489a-b2f0-b4110c0e6e5f)


What you learned through solving this challenge:

1. Reading questions and hints properly can give u the answer sometimes.

Other incorrect methods you tried:

- Tried putting a random option based on its actual size in real life and it didnt work.

References

- https://www.geeksforgeeks.org/format-specifiers-in-c/
