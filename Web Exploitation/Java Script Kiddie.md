# Java Script Kiddie

*Flag:* picoCTF{066cad9e69c5c7e5d2784185c0feb30b}

How you approached the challenge:

- step 1: I saw the source code of the website
```
<html>
	<head>    
		<script src="jquery-3.3.1.min.js"></script>
		<script>
			var bytes = [];
			$.get("bytes", function(resp) {
				bytes = Array.from(resp.split(" "), x => Number(x));
			});

			function assemble_png(u_in){
				var LEN = 16;
				var key = "0000000000000000";
				var shifter;
				if(u_in.length == LEN){
					key = u_in;
				}
				var result = [];
				for(var i = 0; i < LEN; i++){
					shifter = key.charCodeAt(i) - 48;
					for(var j = 0; j < (bytes.length / LEN); j ++){
						result[(j * LEN) + i] = bytes[(((j + shifter) * LEN) % bytes.length) + i]
					}
				}
				while(result[result.length-1] == 0){
					result = result.slice(0,result.length-1);
				}
				document.getElementById("Area").src = "data:image/png;base64," + btoa(String.fromCharCode.apply(null, new Uint8Array(result)));
				return false;
			}
		</script>
	</head>
	<body>

		<center>
			<form action="#" onsubmit="assemble_png(document.getElementById('user_in').value)">
				<input type="text" id="user_in">
				<input type="submit" value="Submit">
			</form>
			<img id="Area" src=""/>
		</center>

	</body>
</html>
```
So i got an idea that they have scrambled the png file by interchaging stuff in its hex code.I reloaded the website with network tab and i got like this

![image](https://github.com/user-attachments/assets/b7cebaff-da0b-4812-aa8e-3d807ec75c36)

- step 2: I could see that this is the scrambled pngs decimal code so i went to convert them to hex and open it in hxd editor.

![0b96549929bf4f8b9549ff840129f744 1](https://github.com/user-attachments/assets/35154fc2-cb74-4883-bcc9-413b9ef8dbcf)

![eb5f32fbbe964baf99a59c84cca777b2 1](https://github.com/user-attachments/assets/0373675b-96ad-47cd-a477-4a703441566c)

Then i went to a website to see the top 16 bytes of png file and compared it with this scrambled png.

- step 3: 

![4420de47f65949dabd7e408707fe3eca 1](https://github.com/user-attachments/assets/d3ec70e4-d0e9-4c17-9af3-8b226be39b43)

SO when i saw it i realised that i can get the shift by comparing with magic header
and by doing that we will get like this 51081803xyz63640 where x and z can be 2,3,4 and y can be 3,4,5,6.
So i needed to bruteforce so i asked chatgpt for all possible combinations.

- step 4: 

![WhatsApp Image 2024-12-25 at 00 21 35_08480d76](https://github.com/user-attachments/assets/8a7f46e4-3926-4a7d-82ad-e80ef75cf490)

And now i tried one by one all the combinations and for this "5108180345363640" i got the flag!!

![WhatsApp Image 2024-12-25 at 00 21 22_45069752](https://github.com/user-attachments/assets/6f8a09b8-41f9-40b8-a756-f22505e27298)

What you learned through solving this challenge:

1. Understand the Javascript code and try to make a script or else see what they want and try if bruteforce is possible.
2. Dont plain bruteforce do it smartly like here i decreased the total no of combinations from 10^16 to 36.

Other incorrect methods you tried:

- No incorrect methods tried.

References

- https://www.rapidtables.com/convert/number/ascii-hex-bin-dec-converter.html
