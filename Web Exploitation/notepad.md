# notepad

*Flag:* picoCTF{styl1ng_susp1c10usly_s1m1l4r_t0_p4steb1n}

How you approached the challenge:

- step 1: Actually before approaching this challenge i had solved a challenge in HTB related to ssti and when i saw similar stuffs i realised that this challenge might be related to ssti injection.
i tried to make an error and in the url it gave error = bad_content so i changed it to bruh for fun and it showed this
 
![5312b5bd10724ab58811122e23d037c1 1](https://github.com/user-attachments/assets/6c0d8ef9-25ef-4e65-b446-a406b9dae943)

After this i got suspicious and thought that this might be some injection so i went to source code.

- step 2:

 ![26ae0355a89d433c8571d2bce4ea0c8e 1](https://github.com/user-attachments/assets/6f10720e-3b6d-4633-8378-949b173b9940)

Seeing this i realised that error is contolled by us and there was this also

![image](https://github.com/user-attachments/assets/da342883-5fa4-456e-8283-8fda869525cd)

- step 3: So i was like i have to go to app/templates/errors and with ..\(like windows bcs here / is not allowed) so i went to wordcounter to count the exact no and even added a ssti injection at the end.

![9af259fba6a64a348193e9277283672c 1](https://github.com/user-attachments/assets/58473bbd-a3e0-4b7d-a8b1-c5ae9f03f6e1)

And boom it answered like this

![13f8fa9ff530446f8e857f2734f9ca8d 1](https://github.com/user-attachments/assets/bf0c87af-df49-49ce-9b85-b1db69b8237c)

So i was sure this is ssti so now i went to different kinds of payloads tried many of them but took me a loot of time untill i found this

![WhatsApp Image 2024-12-28 at 00 57 22_3b5d589e](https://github.com/user-attachments/assets/5efa8e0c-0773-4690-8e43-c6ec7d43c085)

And this worked.

- step 4:The payload was ..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\app\templates\errors\aa{% with a = request["application"]["\x5f\x5fglobals\x5f\x5f"]["\x5f\x5fbuiltins\x5f\x5f"]["\x5f\x5fimport\x5f\x5f"]("os")["popen"]("echo stuff")["read"]() %}{{a}}{% endwith %}
so i changed it to ls and it gave me like this

![WhatsApp Image 2024-12-28 at 01 01 24_d0c76269](https://github.com/user-attachments/assets/3a606bcc-6662-4a7f-a2a9-6c09e0769d38)

so i got the txt file i had to just cat it now.

- step 5:And on doing that i got my flag!

![WhatsApp Image 2024-12-28 at 01 02 57_c5deb78a](https://github.com/user-attachments/assets/f2ea6f85-1459-42ac-b4c9-bd7597f4cf74)

What you learned through solving this challenge:

1. About Ssti's
2. About Jinja2
3. Ssti injection

Other incorrect methods you tried:

- many payloads to narrow down to this one

References

- https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Images/serverside.png
- https://wordcounter.net/
